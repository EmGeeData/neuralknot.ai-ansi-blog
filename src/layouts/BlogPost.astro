---
import type { CollectionEntry } from "astro:content";
import BaseHead from "../components/BaseHead.astro";
import { FOOTER_CONFIG } from "../consts";
import "../styles/blog-post.css";

type Props = CollectionEntry<"blog">["data"];

const { title, description, pubDate, updatedDate } = Astro.props;
---

<html lang="en">
  <head>
    <BaseHead title={title} description={description} />
    <script src="/terminal.js" is:inline></script>
    <script src="/theme-switcher.js" is:inline></script>
    <script is:inline>
      document.addEventListener("DOMContentLoaded", function () {
        // Initialize theme selector
        const placeholder = document.getElementById(
          "theme-selector-placeholder"
        );
        if (placeholder && window.ThemeSwitcher) {
          const selector = window.ThemeSwitcher.createThemeSelector();
          placeholder.appendChild(selector);
        }
      });
    </script>
  </head>

  <body>
    <div class="blog-container">
      <div class="blog-header">
        <div class="blog-title">{title}</div>
        <div class="blog-meta">
          Published: {pubDate.toLocaleDateString()}
          {updatedDate && ` • Updated: ${updatedDate.toLocaleDateString()}`}
        </div>
        <div class="blog-meta">Tech Article • NeuralKnot Archive</div>
        <div class="theme-selector-container">
          <span class="theme-selector-label">THEME:</span>
          <div id="theme-selector-placeholder"></div>
        </div>
      </div>

      <div class="blog-nav">
        <a href="/">◄ Home Terminal</a>
        <a href="/blog">◄ Blog Archives</a>
        <a href="/about">About System</a>
      </div>

      <article class="blog-content">
        <slot />
      </article>

      <div class="blog-footer">
        <div>{FOOTER_CONFIG.post.statusLine}</div>
        <div class="blink">
          {FOOTER_CONFIG.post.promptText}<span class="cursor"></span>
        </div>
        <div style="margin-top: 1em; font-size: 0.8em;">
          {FOOTER_CONFIG.common.copyright} Tech Archive<br />
          Article: "{title}" • {FOOTER_CONFIG.common.fidonet}
        </div>
      </div>
    </div>
  </body>
</html>
